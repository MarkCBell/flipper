\documentclass[a4paper]{article}

\usepackage{header_math, header_article}
\usepackage{fullpage}
\usepackage[percent]{overpic}
\usepackage{graphicx}
\graphicspath{{figures/}}
\usepackage{framed}
\usepackage{examplep}
\newcommand{\exc}[1]{\mbox{\PVerb{#1}}}
\usepackage{listings}
\usepackage{color}
\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}
\lstset{frame=L,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true
  tabsize=3
}

\title{A users guide to flipper}
\author{Mark Bell}

\begin{document}

\maketitle

\begin{center}
\begin{minipage}{0.8\linewidth}
\begin{framed}
  To get, install, test and start the flipper application under Python using Pip:
  \begin{lstlisting}
  > python -m pip install flipper-triangulation --user
  > python -m flipper.test
  > python -m flipper.app
  \end{lstlisting}
\end{framed}
\end{minipage}
\end{center}

Flipper is a program for computing the action of mapping classes on laminations on a punctured surface using ideal triangulation coordinates. It can decide the Nielsen--Thurston type of a given mapping class and, for pseudo-Anosov mapping classes, construct a layered, veering triangulation of their mapping torus, as described by Agol \cite{Agol}. Flipper is currently under development and this users guide will be based on flipper 0.5.7.


Flipper can be run as a Python 2, Python 3 or Sage Python module \cite{sage}. It has been tested on:
\begin{itemize}
 \item Python 2.7.8 on Windows 7,
 \item Python 3.3.4 on Windows 7,
 \item Python 3.4.1 on Windows 7,
 \item Python 2.7.6 on Ubuntu 14.04,
 \item Python 3.4.0 on Ubuntu 14.04, and
 \item Sage 6.3 on Ubuntu 14.04.
\end{itemize}
Some of its features require exact arithmetic. Although these calculations can be done in pure Python, Sage's libraries appear to be significantly faster.

\section{Getting flipper}

Flipper is available on the Python Package Index (PyPI). The preferred method for installing the latest stable release is to use pip:
\begin{lstlisting}
> python -m pip install flipper-triangulation --user
\end{lstlisting}
Pip can be installed using get-pip.py from \url{http://pip.readthedocs.org/en/latest/installing.html} and is included in Python 3.4 by default.

Flipper can also be installed through the older easy\_install:
\begin{lstlisting}
> python -m easy_install flipper-triangulation
\end{lstlisting}

Some basic commands that can be run once flipper has been installed are listed in Table~\ref{tbl:package_commands}.

\begin{table}[ht]
\label{tbl:package_commands}
\begin{center}
\begin{tabular}{l|l}
Command & Effect \\
\hline
\begin{lstlisting}
> python -m flipper
\end{lstlisting} & Display information about flipper. \\

\begin{lstlisting}
> python -m flipper.app
\end{lstlisting} & Start the flipper GUI application. \\

\begin{lstlisting}
> python -m flipper.doc
\end{lstlisting} & Open this documentation. \\

\begin{lstlisting}
> python -m flipper.test
\end{lstlisting} & Run the test suite. \\

\begin{lstlisting}
> python -m flipper.profile
\end{lstlisting} & Run the profiling suite. \\
\end{tabular}
\end{center}
\caption{Flipper package commands.}
\end{table}

If you find flipper useful in your research, please consider citing it. A suggested reference is:
\begin{verbatim}
  Mark Bell. flipper (Computer Software).
  https://bitbucket.org/Mark_Bell/flipper/, 2013--2014. Version <<version>>.
\end{verbatim}
or the BibTeX entry:
\begin{verbatim}
  @Misc{flipper,
    author = {Bell, Mark},
    title = {flipper (Computer Software)},
    howpublished = {\url{https://bitbucket.org/Mark_Bell/flipper/}},
    year = {2013--2014},
    note = {Version <<version number used>>}
  }
\end{verbatim}

\subsection{Dependencies}

The flipper kernel has no required dependencies. However, some of the examples and tests using the kernel require SnapPy \cite{SnapPy}. Additionally, the flipper application requires Tkinter. You can obtain this on Ubuntu by using the command:
\begin{lstlisting}
> apt-get install python-tk
\end{lstlisting}
If you are running flipper as a Sage Python module then your Tkinter install may not be recognised and you may see an error such as: \exc{Error: no module named _tkinter}. To fix this install the tcl/tk development library and then rebuild Sage's Python. On Ubuntu you can do this using the commands:
\begin{lstlisting}
> apt-get install tk8.5-dev
> sage -f python
\end{lstlisting}
Note that there are several known issues with tcl/Tk on Mac OS X, see \url{https://www.python.org/download/mac/tcltk}.

\subsection{Flipper devolpment version}
Although the latest stable release of flipper is available through PyPI, you can get the latest development version of flipper from \url{https://bitbucket.org/mark_bell/flipper} or straight from the Mercurial \cite{mercurial} repository with the command:
\begin{lstlisting}
> hg clone https://bitbucket.org/mark_bell/flipper
\end{lstlisting}
To compile flipper use the command:
\begin{lstlisting}
> python setup.py install --user
\end{lstlisting}

At some point the BitBucket repository may also include precompiled binaries.

\section{The flipper application}

\subsection{Getting started}

Once installed the flipper application can be started by using the command:
\begin{lstlisting}
> python -m flipper.app
\end{lstlisting}

The main window of flipper is shown in Figure~\ref{fig:main}. It has a canvas for drawing on (1) and a list of known laminations and mapping classes (2).

\begin{figure}[ht]
\begin{center}
\begin{overpic}[width=0.75\textwidth]{figures/main}
 \put (30, 65) {\textcolor{red}{\large$1$}}
 \put (95, 66) {\textcolor{red}{\large$2$}}
\end{overpic}
\end{center}
\caption{The main flipper window.}
\label{fig:main}
\end{figure}

\begin{remark}
The currently selected object is highlighted in red. You can cancel your current selection at any time by clicking on the object again, pressing \exc{Escape} or double clicking. Additionally you can delete the currently selected object by pressing either \exc{Delete} or \exc{Backspace}.
\end{remark}

\subsection{Creating a triangulation}

To create a triangulation, click on the canvas to create vertices. Click on two in succession to connect them via an edge. You cannot add an edge if it would meet the interior of an existing edge. Click on two edges, each of which are part of exactly one triangle, in succession to identify them. Clicking on an identified edge will destroy the identification.

Flipper automatically adds triangles between any triple of vertices each of which is pairwise connected via an edge. 

The triangulation is \emph{complete} if each edge is either contained in two triangles or is contained in one triangle and is identified with another. Once the triangulation is complete flipper will switch to interpret clicks as drawing a lamination. You can force flipper to place a vertex or select an edge, even if the triangulation is complete, by holding \exc{Shift} while clicking.

\subsection{Adding laminations}

Once the surface drawn is complete you can start drawing laminations on it. Click on the canvas to start drawing. Click on the canvas again to extend it through the current point. To finish drawing a section of curve press \exc{Escape} or double click.

You can remove the last point currently being drawn by either pressing \exc{Delete} or \exc{Backspace}. You should make sure to draw transverse to the underlying triangulation. 

The currently drawn lamination can be added to the list of known laminations by using the action \exc{Laminations > Store}.

\subsection{Adding mapping classes}

There are currently four different basic types of mapping classes that can be created.

\begin{itemize}
\item Dehn twist - A Dehn twist about the currently drawn lamination can be created by using the action \exc{Mapping classes > Store... > Twist}. This can only be done if the lamination is actually a curve. Alternatively, if this curve is in the list of known laminations and is listed as twistable then double click on \exc{Twistable: True}.
\item Half twist - A half twist about the currently drawn lamination can be created by using the action \exc{Mapping classes > Store... > Half twist}. This can only be done if the lamination is actually a curve. Alternatively, if this curve is in the list of known laminations and is listed as half twistable then double click on \exc{Half twistable: True}.
\item Isometry - An isometry of the underlying triangulation can be created by using the action \exc{Mapping classes > Store... > Isometry}. The isometry should be specified by a string of the from \exc{<from>:<to> <from>:<to> <from>:<to>} indicating which edges should be sent to which edges. If this string does not specify a unique isometry then an arbitary one will be chosen.
\item Composition - A composition of existing mapping classes can be created by using the action \exc{Mapping classes > Store... > Composition}. The composition should be specified by a string of mapping class names and inverse names separated by periods where necessary.
\end{itemize}

\begin{remark*}
Currently flipper is only capable of performing Dehn twists and half twists about \emph{good curves}, where every complementary region contains at least one puncture. Hence, for example, it cannot perform a half twist on a twice marked surface.
\end{remark*}

\subsection{Object properties}

Stored laminations and mapping classes appear in the object list. Clicking on a object will show more information about it and actions involving it. If a property can be computed in polynomial time then it is automatically listed otherwise it will be listed as \exc{?}. You can ask flipper to compute any unknown property by double clicking on it. Some properties prevent other actions from being taken and so are listed as \exc{x}. For example, flipper cannot compute the invariant lamination of a periodic mapping class.

\subsubsection{Lamination properties}

The properties and methods of a known lamination are:
\begin{itemize}
\item Show - Renders this lamination on the current triangulation.
\item Multicurve: True / False
\item Twistable: True / False
\item Half twistable: True / False
\item Filling: True / False
\end{itemize}

\subsubsection{Mapping class properties}

The properties and methods of a known mapping class are:
\begin{itemize}
\item Apply - Applies this mapping class to the currently drawn lamination.
\item Apply inverse - Applies the inverse of this mapping class to the currently drawn lamination.
\item Order: Infinite / $\NN$
\item Type: Periodic / Reducible / Pseudo-Anosov - The Nielsen--Thurston type of this mapping class.
\item Invariant lamination - Finds a lamination which is projectively invariant under this mapping class.
\end{itemize}

%\section{The flipper kernel}

%\subsection{Getting started}

%TO DO.

\bibliographystyle{plain}
\bibliography{bibliography}


\end{document}
