\documentclass[a4paper]{article}

\usepackage{header_math, header_article}
\usepackage{fullpage}
\usepackage[percent]{overpic}
\usepackage{graphicx}
\graphicspath{{figures/}}
\usepackage{framed}
\usepackage{mdframed}
\usepackage{examplep}
\newcommand{\exc}[1]{\mbox{\PVerb{#1}}}
\usepackage{listings}
\usepackage{color}
\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}
\lstset{frame=L,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  xleftmargin=0.5in,
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3
}

\title{A users guide to flipper (0.9.0)}
\author{Mark Bell}

\begin{document}

\maketitle

\begin{center}
\begin{minipage}{0.8\linewidth}
\begin{framed}
  To get, install, test and start the flipper application under Python using Pip:
  \begin{lstlisting}
  > python -m pip install flipper --user --upgrade
  > python -m flipper.test
  > python -m flipper.app
  \end{lstlisting}
\end{framed}
\end{minipage}
\end{center}

Flipper is a program for computing the action of mapping classes on laminations on a punctured surface using ideal triangulation coordinates. It can decide the Nielsen--Thurston type of a given mapping class and, for pseudo-Anosov mapping classes, construct a layered, veering triangulation of their mapping torus, as described by Agol \cite{Agol}. Flipper is currently under development and this users guide will be based on flipper 0.7.7.

Flipper can be run as a Python 2, Python 3 or Sage Python module \cite{sage}. It has been tested on:

\begin{center}
\begin{tabular}{c|c|c}
Windows 7 & Windows 8.1 & Ubuntu 14.04 \\
\hline
Python 2.7.8 & & Python 2.7.8 \\
Python 3.4.2 & Python 3.4.2 & Python 3.4.2 \\
 & & Sage 6.5 \\
\end{tabular}
\end{center}

Some of its features require exact arithmetic. Although these calculations can be done in pure Python, Sage's libraries appear to be significantly faster and so are recommended. For even more speed ($\sim$25\% more) consider running flipper with the \texttt{-O} optimise bytecode option.

\section{Getting flipper}

Flipper is available on the Python Package Index (PyPI). The preferred method for installing the latest stable release is to use Pip:
\begin{lstlisting}
> python -m pip install flipper --user --upgrade
\end{lstlisting}
Pip can be installed using \texttt{get-pip.py} from \url{http://pip.readthedocs.org/en/latest/installing.html} and is included in Python 2.7.9 and Python 3.4 by default.

Although not officially supported, flipper can often also be installed using \texttt{easy\_install}:
\begin{lstlisting}
> python -m easy_install flipper
\end{lstlisting}

\subsection{Optional dependencies}

The flipper kernel has no required dependencies. However some of the included subpackages do require additional modules:

\begin{itemize}
\item Tkinter: Required for the flipper application. On Ubuntu install using the command:
\begin{lstlisting}
> apt-get install python-tk
\end{lstlisting}
Note that if you are running flipper as a Sage Python module then your Tkinter install may not be recognised and you may see an error such as: \exc{Error: no module named _tkinter}. To fix this install the tcl/tk development library and then rebuild Sage's Python. On Ubuntu you can do this using the commands:
\begin{lstlisting}
> apt-get install tk8.5-dev
> sage -f python
\end{lstlisting}
\item SnapPy \cite{SnapPy}: Required for some of the examples and tests. Install using the command:
\begin{lstlisting}
> python -m pip install snappy --user --upgrade
\end{lstlisting}
\end{itemize}

\subsection{Citing flipper}

If you find flipper useful in your research, please consider citing it. A suggested reference is:
\begin{verbatim}
  Mark Bell. flipper (Computer Software).
  https://bitbucket.org/Mark_Bell/flipper/, 2013--2014. Version <<version>>.
\end{verbatim}
or the BibTeX entry:
\begin{verbatim}
  @Misc{flipper,
    author = {Bell, Mark},
    title = {flipper (Computer Software)},
    howpublished = {\url{https://bitbucket.org/Mark_Bell/flipper/}},
    year = {2013--2014},
    note = {Version <<version number used>>}
  }
\end{verbatim}
or the BibItem:
\begin{verbatim}
  \bibitem{flipper} Mark bell: \emph{flipper (Computer Software)},
    \url{https://bitbucket.org/Mark_Bell/flipper/}}, (2013--2014),
    Version <<version number used>>
\end{verbatim}

\subsection{Flipper development version}
Although the latest stable release of flipper is available through PyPI, you can get the latest development version of flipper from \url{https://bitbucket.org/mark_bell/flipper} or straight from the Mercurial \cite{mercurial} repository with the command:
\begin{lstlisting}
> hg clone https://bitbucket.org/mark_bell/flipper
\end{lstlisting}
To compile flipper use the command:
\begin{lstlisting}
> python setup.py install --user
\end{lstlisting}

At some point the BitBucket repository may also include precompiled binaries.

\subsection{Known issues}

\begin{itemize}
\item Before version 0.7.1, flipper was listed on PyPI as \texttt{flipper-triangulation}. If you have a version older than 0.7.0 you may need to manually remove it before beginning the install / upgrade process.
\item There is currently no support for flipper on Mac OS. Additionally there are several known issues with tcl/Tk on Mac OS X, see \url{https://www.python.org/download/mac/tcltk} for more information.
\end{itemize}

\section{The flipper application}

Some basic commands that can be run once flipper has been installed are listed in Table~\ref{tbl:package_commands}.

\begin{table}[ht]
\label{tbl:package_commands}
\begin{center}
\begin{tabular}{l|l}
Command & Effect \\
\hline
\begin{lstlisting}
> python -m flipper
\end{lstlisting} & Display information about flipper. \\

\begin{lstlisting}
> python -m flipper.app
\end{lstlisting} & Start the flipper GUI application. \\

\begin{lstlisting}
> python -m flipper.doc
\end{lstlisting} & Open this documentation. \\

\begin{lstlisting}
> python -m flipper.test
\end{lstlisting} & Run the test suite. \\

\begin{lstlisting}
> python -m flipper.example
\end{lstlisting} & List included examples. \\

\begin{lstlisting}
> python -m flipper.profile
\end{lstlisting} & Run the profiling suite. \\
\end{tabular}
\end{center}
\caption{Flipper package commands.}
\end{table}

\subsection{Getting started}

Once installed the flipper application can be started by using the command:
\begin{lstlisting}
> python -m flipper.app
\end{lstlisting}

The main window of flipper is shown in Figure~\ref{fig:main}. It has a canvas for drawing on (1) and a list of known laminations and mapping classes (2).

\begin{figure}[ht]
\begin{center}
\begin{overpic}[width=0.75\textwidth]{figures/main}
 \put (30, 65) {\textcolor{red}{\large$1$}}
 \put (95, 66) {\textcolor{red}{\large$2$}}
\end{overpic}
\end{center}
\caption{The main flipper window.}
\label{fig:main}
\end{figure}

\begin{remark}
The currently selected object is highlighted in red. You can cancel your current selection at any time by clicking on the object again, pressing \exc{Escape} or double clicking. Additionally you can delete the currently selected object by pressing either \exc{Delete} or \exc{Backspace}.
\end{remark}

\subsection{Included Examples}

Flipper includes several example triangulations of surfaces. One can be loaded by using the action \exc{File > Open example...}. Flipper includes all of the standard generating sets used by \cite{BundleCensuses} and \cite{KnotInfo}. 

From within this menu you can also request flipper to automatically construct a polygon with a desired edge identification. To do this use the option \exc{circular n-gon} and specify the gluings by a string of upper and lower case letters. Each letter of this string corresponds to an edge, ordered anti-clockwise, and an edge with a lower case letter is identified with the edge with the corresponding upper case letter. For example \exc{abAB} gives the once-punctured torus and \exc{xyzXZY} gives the twice punctured torus.

Similiarly the option \exc{radial n-gon} creates a polygon with the specified edge identifications but with an additional vertex at its centre.

\subsection{Creating a triangulation}

To create a triangulation, click on the canvas to create vertices. Click on two in succession to connect them via an edge. You cannot add an edge if it would meet the interior of an existing edge. Flipper automatically adds triangles between any triple of vertices, each pair of which is connected via an edge. Click on two edges, each of which are part of exactly one triangle, in succession to identify them. Clicking on an identified edge will destroy the identification.

The triangulation is \emph{complete} if each edge is either contained in two triangles or is contained in one triangle and is identified with another. Once the triangulation is complete flipper will switch to interpreting clicks as drawing a lamination. You can force flipper to place a vertex or select an edge, even if the triangulation is complete, by holding \exc{Shift} while clicking.

\subsection{Adding laminations}

Once the surface drawn is complete you can start drawing laminations on it. Click on the canvas outside of the drawn surface to start drawing a lamination. Click on the canvas again to extend it through the current point. Click outside of the drawn surface to finish drawing.

You can remove the last point currently being drawn by either pressing \exc{Delete} or \exc{Backspace}. You should make sure to draw transverse to the underlying triangulation. 

The currently drawn lamination can be added to the list of known laminations by using the action \exc{Create > Lamination}.

\subsection{Adding mapping classes}

There are currently four different ways of creating mapping classes.

\begin{itemize}
\item Dehn twist - A Dehn twist about the currently drawn lamination can be created by using the action \exc{Create > Mapping class > Twist}. This can only be done if the lamination is actually a curve.
\item Half twist - A half twist about the currently drawn lamination can be created by using the action \exc{Create > Mapping class > Half twist}. This can only be done if the lamination is actually a curve which cuts of a twice marked disk.
\item Isometry - An isometry of the underlying triangulation can be created by using the action \exc{Create > Mapping class > Isometry}. The available isometries are listed according to how they permute edges.
\item Composition - A composition of existing mapping classes can be created by using the action \exc{Create > Mapping class > Composition}. The composition should be specified by a string of mapping class names separated by periods where necessary. Powers may be specified and the swapcase of a name is synonymous with its inverse mapping class.
\end{itemize}

\begin{remark*}
Currently flipper is only capable of computing Dehn twists and half twists about \emph{non-isolating curves}, where every complementary region contains at least one puncture. Hence, for example, half twist on a twice marked surface cannot be computed in the application.
\end{remark*}

\subsection{Object properties}

Stored laminations and mapping classes appear in the object list. Clicking on a object will show more information about it and actions involving it.

Mapping classes also include a list of properties. If a property can be computed in polynomial time then it is automatically listed otherwise it will be listed as \exc{?}. You can ask flipper to compute any unknown property by double clicking on it. Some properties prevent other actions from being taken and so are listed as \exc{x}. For example, flipper cannot compute the invariant lamination of a periodic mapping class.

The properties of a mapping class are:
\begin{itemize}
\item Order: Infinite / $\NN$.
\item Type: Periodic / Reducible / Pseudo-Anosov - The Nielsen--Thurston type of this mapping class.
\item Invariant lamination - Finds a lamination which is projectively invariant under this mapping class.
\item Conjugate to - Determines if this mapping class is conjugate to another.
\item Bundle - Constructs a layered, veering triangulation of this mapping classes mapping torus.
\end{itemize}

%\section{The flipper kernel}

%\subsection{Getting started}

%TO DO.

\bibliographystyle{plain}
\bibliography{bibliography}


\end{document}
